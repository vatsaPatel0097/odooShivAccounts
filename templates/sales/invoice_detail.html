{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <div class="card p-3">
    <h4>Customer Invoice INV/{{ invoice.pk }}</h4>
    <p><strong>Customer:</strong> {{ invoice.customer }}</p>
    <p><strong>Date:</strong> {{ invoice.issue_date }}</p>
    <p><strong>Status:</strong> 
      {% if invoice.status == 'draft' %}
        <span class="badge bg-secondary">Draft</span>
      {% elif invoice.status == 'confirmed' %}
        <span class="badge bg-success">Confirmed</span>
      {% else %}
        <span class="badge bg-danger">Cancelled</span>
      {% endif %}
    </p>

    <table class="table table-dark table-sm">
      <thead>
        <tr>
          <th>Product</th>
          <th>Qty</th>
          <th>Unit Price</th>
          <th>Tax %</th>
          <th>Tax Amt</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        {% for line in invoice.lines.all %}
        <tr>
          <td>{{ line.product }}</td>
          <td>{{ line.qty }}</td>
          <td>{{ line.unit_price }}</td>
          <td>{{ line.tax_percent }}</td>
          <td>{{ line.tax_amount }}</td>
          <td>{{ line.line_total }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="mt-3">
      {% if invoice.status == 'draft' %}
        <a href="{% url 'customer_invoice_confirm' invoice.pk %}" 
           class="btn btn-success">Confirm Invoice</a>
      {% endif %}
      {% if invoice.status == 'confirmed' %}
        <a href="{% url 'customer_invoice_receive_payment' invoice.pk %}" 
           class="btn btn-primary">Receive Payment</a>
      {% endif %}
      <a href="{% url 'customer_invoices_list' %}" class="btn btn-secondary">Back</a>
    </div>
  </div>
</div>
{% endblock %}
